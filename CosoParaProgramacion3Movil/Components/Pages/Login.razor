@page "/login"
@inject NavigationManager Navigation
@inject AuthService AuthService

<h3>Iniciar Sesión</h3>

@if (!string.IsNullOrEmpty(mensajeError))
{
    <div class="alert alert-danger">@mensajeError</div>
}

<button class="btn btn-primary" @onclick="Volver">Volver</button>

<div class="form-group">
    <label>Nombre de usuario</label>
    <input class="form-control" @bind="nombre" placeholder="Ingrese su nombre" />
</div>

<div class="form-group">
    <label>Contraseña</label>
    <input type="password" class="form-control" @bind="contrasena" placeholder="Ingrese su contraseña" />
</div>

<div class="form-group mt-3">
    <button class="btn btn-primary" @onclick="IniciarSesion">Ingresar</button>
</div>

@code {
    private string nombre = string.Empty;
    private string contrasena = string.Empty;
    private string mensajeError;

    private void Volver()
    {
        Navigation.NavigateTo("/");
    }

    private async Task IniciarSesion()
    {
        mensajeError = string.Empty;

        var loginExitoso = await AuthService.LoginAsync(nombre, contrasena);

        if (loginExitoso)
        {
            // Ir al menú principal o página inicial
            Navigation.NavigateTo("/");
        }
        else
        {
            mensajeError = "Credenciales incorrectas. Intente nuevamente.";
        }
    }
}
